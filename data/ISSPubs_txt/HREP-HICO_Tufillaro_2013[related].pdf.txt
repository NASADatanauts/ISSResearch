"","x"
"1","Behavioral model and simulator for the Multl-sllt Optlmized
Spectrometer (MOS)
Nicholas Tuﬁllaroa, Curtiss O. Davisa, Tim Valleb, William Goodb, Michelle Stephensb, and
Peter Spuhlerb
aCOllege of Earth, Ocean and Atmospheric Sciences,
Oregon State University, Corvallis, OR 97331
bBall Aerospace, Boulder, CO 80301
ABSTRACT
The Multi—Slit Optimized Spectrometer (MOS) is a NASA funded Instrument Incubator Program (HP) to
advance an innovative dispersive spectrometer concept in support of the GEO—CAPE ocean science mission.
As part of the instruments design and testing, we constructed a ‘behavioral model’ of the instrument’s optical
engine which allows an end—to—end simulation from input radiances to ﬁnal product maps. Here we describe the
model used for a rapid, but realistic, simulation of the MOS optical engine, and give illustrative examples of
quantitatively tracking errors in the imaging chain from input radiances t0 bounds on ﬁnal product errors.
Keywords: spectrometer, ocean color, GEO—CAPE, simulator
1. INTRODUCTION
End—tO—end simulators are playing an increasing role in the construction and use of imaging spectrometersl’2
In addition to aiding engineering design and evaluation, simulators can also be a sandbox for testing new
signal correction and product algorithms?”4 The Multi—Slit Optimized Spectrometer (MOS) is a NASA funded
Instrument Incubator Program (HP) to advance an innovative dispersive spectrometer concept in support of the
GEO—CAPE ocean science 1rnissi0n.5’6 As part of the instruments design and testing, we constructed a ‘behavioral
model’ of the instrument’s optical engine which allows an end—tO—end simulation from input radiances to ﬁnal
product maps. The MOS SIMulator (MOS—SIM) is a tool designed to enable:
0 Producing products at ‘ﬁrst light’ for MOS,
0 Tracking uncertainties at all stages of imaging and product generation,
0 Making informed design trade—oﬁ's using information about uncertainties in target products,
0 Creating and testing new signal correction and product methods.
A ﬂow diagram showing the steps from the MOS—SIM to ﬁnal product evaluation, and feedback to enable informed
decisions about engineering trade—oﬁ's, is shown in Fig. 1.
2. DESIGN
The MOS—SIM was constructed before the ﬁnal assembly of the MOS using data from an optical simulator used
to prototype the MOS design. The primary reason for creating the simulator early on in the project was to
enable the creation of hyperspectral algorithms to test the design and calibration of MOS before ‘ﬁrst light,’ as
well as enabling the initial debugging of atmospheric correction and product algorithms before the completion
of the optical assembly. MOS—SIM generates ‘synthetic data’ using three components: the Scene Simulator, the
MOS Instrument Simulator, and the Product Generator which includes atmospheric correction (Fig. 2). The
backbone of the simulator is a sequence of functions written in MATLAB which call open source or shareware
codes where indicated.
Imaging Spectrometry XVIII, edited by Pantazis Mouroulis, Thomas S. Pagano, Proc. of SPIE
Vol. 8870, 88700E ' © 2013 SPIE ' CCC code: 0277-786X/13/$18 ' dOi: 10.1117/122023526
Proc. of SPIE Vol. 8870 887OOE-1
Downloaded From: http://pr0ceedings.spiedigitallibrary.0rg/ on 10/15/2014 Terms of Use: http://spiedl.0rg/terms

"
"2","Product
MOS Af h , Genem’rors
mos el’lC
P ' ProdumL
—> C°rrec*'°"" —> “WW“ Maps . —> Evaluation
processor. Sediment Concentration
MOS ..
Figure 1. Flow diagram showing steps in going from the MOS Simulator (MOS—SIM) to ﬁnal product evaluation.
(0) M05 5“"". (b) Simulated MOS Focal Plane Army (FPA) (c) MOS Product Map
‘ ‘ E u
g :xt. 2% w
'3‘! F‘E’FT at w
s \ ' ' ' E m
a > a , g W _
§ ‘ , J v g m
t 9. '
. ~' ‘ - M
if a ”""
i I K 1 a ‘ m ___Yf—ITZ_KT—=C—IZC—ZT—t
hicoZmosm fpaZimgm sm‘s wavelength imgzﬂhm
Figure 2. Main components of MOS—SIM. (a) Scene Simulator generates synthetic scenes for input to MOS—SIM based on
HICOTM images. (b) Focal plane array generated by simulator. ((3) Example product (Fluorescence Line Height Map).
Proc. of SPIE Vol. 8870 887OOE-2
Downloaded From: http://proceedings.spiedigitallibrary.0rg/ on 10/15/2014 Terms of Use: http://spiedl.0rg/terms

"
"3","Based an a dnfabuse 0F A’rmaspheric Simulu’rian Wafer Leaving Radiance
HICG Images {hicnﬂmas} usin- 65V genemi‘ed wi’rh WASH
{'1} 1-15-73 T-""""' {h}. |_ =|_ +|_ +|_ (5]
53.L 1"": Errnh—lr: n
E J.- E: L— F‘ a.
g: t a :— F
s "" E 2 E l— .,
E 5' Ln- :._. “I _.._
s .. \r‘ Hﬁtﬁ'.ii..
I ”.1qu ""_v. i: E 1 T :- E:— u—nu
:1; ii»:- _ '2 Z |_ _—_.n .
. ,-‘e:--. --_31 Scene. Slmula‘l'ﬂr :2 3 -_ E El n... a;;::
. '- '._. _ ..'_-i:.'?'=.""'-:: . 3 .. -,—. I..— ”W EEEZF
,5 --:_.j-}13;1;. produces u’r-sensur radiance “P'—
: '—_.""~'-' WV."" ""3 . . . .
Wil'l'h vnrlubIllfy
Figure 3. MOS—SIM scene simulator (a) HICOTM provides realistic scene parameters.7 (b) Top—of—Atmosphere Radiance
(Lu) is generated from water leaving radiance (Lw), surface reﬂection (LT), and simulated atmospheric scatter (La). (C)
Water leaving radiance simulated using bio—optical models for absorbing and scattering water constituents generated by
WASI4.8
2.1 SYNTHETIC SCENE GENERATION
To generate realistic data we start with hyperspectral images from HICOTM.7 We can input either HICO scenes
into the the front end of the simulator, 0r ‘simulations’ of HICO scenes which allows us to start with exactly
known water and atmospheric parameters. For simulated scenes, we start with a particular HICO scene (e.g. San
Francisco Bay, 11 October 2012 in Fig. 2(a)), extract the View and sun angles, simulate typical atmospheric
scatter with the code 6SV,9 and compute the water leaving radiance with predeﬁned optical properties using
the code VVASI4,8 which provides a wide variety of speciﬁc sediment and algal species models, as well as typical
empirical models for CDOM and Chlorophyll. The speciﬁc Choice of model parameters ﬁxes the Inherent Optical
Properties (IOP’s) for a given pixel. We don’t simulated the whole scene, but only an ensemble of typical pixels
with a Gaussian variance in the model or IOP parameters. If we use a HICO scene directly for the input, then
a Gaussian ensemble of Top—of—Atmosphere (TOA) radiances starting with the HICO image pixels is generated.
In either case, the input to MOS—SIM is typically an ‘ensemble’ of images where the pixels have a prede—
ﬁned Gaussian variation. Plotting this variation as a histogram provides an approximation to the Probability
Distribution Function (PDF), and we track the mean and variance of the PDF at different points of the image
chain to gauge the ‘uncertainty’ of a speciﬁc a speciﬁc image, operation, or product. Strictly speaking, the
transformations along the image chain are nonlinear, thus the PDF is not Gaussian at later stages of the image
Chain. However, the simplicity of the description of uncertainty by mean and variance alone appears sufﬁcient
in this application.
2.2 OPTICAL SIMULATION
Since the uncertainties are tracked using a Monte Carlo method, the optical simulation needs to be very fast.
We achieve speed through extensive use of look up tables. Speciﬁcally, regions on the frontal assembly of MOS
are assigned a coordinate which gets uniquely mapped by a ray as it passes through the optical assembly to one
of the 2048 X 2048 pixels on the Focal Plane Array (FPA). Furthermore, each pixel 0n the FPA is assigned a
precomputed Point Spread Function (PSF) as determined by the engineering design simulation. Additional look
up tables are created for the spectral dispersion of the prism and the model for the read—out electronics. The
only real computation beyond look up tables is the convolution operation for the PSF along the FPA (Fig. 4).
Proc. of SPIE Vol. 8870 88700E—3
Downloaded From: http://proceedings.spiedigitallibrary.0rg/ on 10/15/2014 Terms of Use: http://spiedl.0rg/terms

"
"4","To show how the look up tables are indexed, consider the ‘Forward Map’ for ray optics step in the simulation
Where the notation is speciﬁed in Fig. 5. The forward map notation is written as:
(a)
MOS Chromatic Response . MOS Spatial Response
——> MOS S'mu'mr -
(b) FPA Coordinates in millimeters of ""Output"" (C) point Spread Function
15 wavelength - 300 nm
A 0.8 ""
E 10
8 5 0.7 “i
c _
£9
3 o 0.6
a
.9
E '5 0-5 :i;
E -10 g
‘L 0.4 "" a
-15 xxx!!!—
o.3
-15 -1O -5 0 5 10 15
Figure 4. MOS—SIM Optical Simulation (a) Block diagram of sub—modules. (b) Focal Plane Array (FPA) image. (c)
Example of Point Spread Function.
I(iaj) = ZJk (1)
1:
ji = ji + mad, k) (2)
IPT0d(/iaja k) = FMMG, k)))- (4)
Q is the calibration step, and .7: is the product algorithm. If there is an implicit functional relationship between
the ‘independent’ variables (2', j, k), this can be used to further reduce the number of independent variables. The
original MOS design simulations explicitly gives us a map:
(:87 y? Z7 J(Z7 y? Z)) H (j? g7 j('/’U7y7 Z))' (5)
And to get the ‘forward map’, _ _ _
(1m) M3910) H (kaj, M33110) (5)
the data is ‘binned’ into 2048 buckets determined by the pixel size and original engineering simulation.

Models of instrument artifacts, such as optical distortion, noise (optical and electronic) and read out errors
(electronic) are added to this forward map model, as well as calibrations to remove the systematic signal distor—
tions. After the MOS assembly, the engineering simulation data that goes into MOS—SIM Will be replaced by
experimental measurements.

2.3 EXAMPLE OF TRACKING UNCERTAINTY
Examples of tracking the mean value and standard deviation of the radiance for Level—l (L1) calibrated spectra,
and Level—Z (L2) atmospheric corrected spectra are shown in Fig. 6.
Proc. of SPIE Vol. 8870 887OOE-4
Downloaded From: http://proceedings.spiedigitallibrary.0rg/ on 10/15/2014 Terms of Use: http://spiedl.0rg/terms

"
"5","I(x.y)
Hz”)
Ji(klj)
Y
y J'
‘ BIN
x o
'ﬁxcd
x
z ' k
FORWARD MAP
CAL/
_ READOUT
' ' C‘ —.
: : 00“ J
I ilﬂu .Vﬁlo‘l‘mN
: : 0&6
5 my) F m5)
Iprod(xoY:z)
Figure 5. Outline of notation used to index look up tables for the simulation of MOS.
5000 _ 500 . . . .
.0 0 O OutputSNR O... O OutputSNR
4500 .. 450 0 o .
4000 . .0 400 '0
. .. 0 .0 After
. ' After , '., \ .
3500 o \ . . I 350 o Atmospherlc
3 ° . Callbm’rlon m . . . ,
3000 ' —| 300 o o . Correction
© . . 0. © 0 . ..' o
(I 2500 00."". '. 250 00 . .0 °.
% o ..00 o . g . . .. .
2000 . . . . . U) 200 z . o . .
22 . . o . ° . R o .0 ... .. . o
1500 ’0 .‘ 00 .0 : . o o 0 .
o. .o o .. . . o 150 . o 0. .° . . .
1000 '° .'. . 100 3. . '
3:. ° ' :0 . . o
500 50 . 0
Deviation abou’r mean s-ecfrum Deviation abou’r mean spectrum
0 35° 400 450 500 55° 50° 65° 70° 75° 30° 85° 0 350 400 450 500 550 600 650 700 750 800 850
waveleng’rh (nm) waveleng’rh (nm)
Figure 6. Signal—tO—noise ratio (SNR) estimated as ,u/a(mean/standard deviation) of input and output radiance at (a)
Level—l and (b) Leve1—2.
Proc. of SPIE Vol. 8870 887OOE-5
Downloaded From: http://proceedings.spiedigitallibrary.0rg/ on 10/15/2014 Terms of Use: http://spiedl.0rg/terms

"
"6","3. CONCLUSION

We provided an overview of MOS—SIM. The tool allows us to generate ocean color products, With uncertainties,

at the ‘ﬁrst light’ of M08. Using precomputed look up tables allows rapid simulation of an ensemble of images

With known ocean and atmospheric parameters, and their variation, and this information can be used to gauge

track the uncertainty of ocean products, Which is useful both for the ﬁnal product use, as well as for making

informed engineering trade—offs in the design of the imaging spectrometer.
REFERENCES

[1] Kerekes, J . P., Baum, J . E., and Farrar, K. E., “Analytical model of hyperspectral system performance,” in
[Proceedings of Infrared Imaging Systems: Design, Analysis, Modeling and Testing X, SPIE], 155—166 (1999).

[2] Coppo, P., Chiarantini, L., and Alparone, L., “Design and validation of an end—to—end simulator for imaging
spectrometers,” Optical Engineering 51(11), 111721—1—111721—14 (2012).

[3] Meola, J ., Eismann, M. T., Moses, R. L., and Ash, J . N., “Modeling and estimation of signal—dependent noise
in hyperspectral imagery,” Appl. Opt. 50, 3829—3846 (Jul 2011).

[4] USS, M. L., Vozel, 13., Lukin, V. V., and Chehdi, K., “Maximum likelihood estimation of spatially correlated
signal—dependent noise in hyperspectral images,” Optical Engineering 51(11), 111712—1—111712—11 (2012).

[5] Valle, T., Hardesty, 0., Davis, 0. 0., Tuﬁllaro, N., Stephens, M., Good, W., and Spuhler, P., “Multislit
optimized spectrometer for ocean color remote sensing,” Published in SPIE Proceedings Volume 8510: Earth
Observing Systems XVII, 851000—5 (2012).

[6] Valle, T., Hardesty, 0., Davis, 0. 0., Tuﬁllaro, N., Good, W., Seeker, 0., and Spuhler, P., “Multislit
optimized spectrometer for ocean color remote sensing: fabrication and assembly update,” Proceedings of
SPIE: Imaging Spectrometry XVIII (8870) (2013).

[7] Lucke, R. L., Corson, M., MCGlothlin, N. R, Butcher, S. D., Wood, D. L., Korwan, D. R, Li, R. R, Snyder,
W. A., Davis, 0. 0., and Chen, D. T., “Hyperspectral imager for the coastal ocean: instrument description
and ﬁrst images,” Appl. Opt. 50, 1501—1516 (Apr 2011).

[8] Gege, P., “Analytic model for the direct and diffuse components of downwelling spectral irradiance in water,”
Appl. Opt. 51, 1407—1419 (Mar 2012).

[9] KotChenova, S. Y., Vermote, E. F., Matarrese, R, and Frank J . Klemm, J ., “Validation of a vector version
of the 68 radiative transfer code for atmospheric correction of satellite data. part 1: Path radiance,” Appl.
Opt. 45, 6762—6774 (Sep 2006).

Proc. of SPIE Vol. 8870 887OOE-6
Downloaded From: http://pr0ceedings.spiedigitallibrary.0rg/ on 10/15/2014 Terms of Use: http://spiedl.0rg/terms

"
